<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Carrie Documentation</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="introduction.html">Introduction</a></li><li class="chapter-item expanded affix "><li class="part-title">[title better; cat's notes on how to do this]</li><li class="chapter-item expanded "><a href="where-to-start.html"><strong aria-hidden="true">1.</strong> Where to Start</a></li><li class="chapter-item expanded "><a href="building-her.html"><strong aria-hidden="true">2.</strong> Building Her</a></li><li class="chapter-item expanded "><a href="tools.html"><strong aria-hidden="true">3.</strong> Tools</a></li><li class="chapter-item expanded "><a href="programming-her.html"><strong aria-hidden="true">4.</strong> Programming Her</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Carrie Documentation</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="where-to-start"><a class="header" href="#where-to-start">Where to Start</a></h1>
<p>bro just ask jeannette</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="building-her"><a class="header" href="#building-her">Building Her</a></h1>
<p>For mechanical notes... ask Jeannette.</p>
<h2 id="rear-motors"><a class="header" href="#rear-motors">Rear Motors</a></h2>
<p>Ensure the rear motors are connected to their motor controller with opposite
polarity (i.e., ensure the black lead of one motor is connected to the red lead
of the other), and connect the joined leads to the output of the motor
controller. The polarity (if wrong) will be corrected in a later step. One way
to do this neatly is to have a splitter after the motor controller (input on
the bottom, output on the right):</p>
<p><img src="./images/rear-motor-hookup.jpg" alt="rear motor hookup" /></p>
<h2 id="steering-motor"><a class="header" href="#steering-motor">Steering Motor</a></h2>
<p>The steering motor has six wires coming out of it -- two for power, four for
the encoder control. Those hook up to the Pico as follows (indexed by color):</p>
<div class="table-wrapper"><table><thead><tr><th>Color</th><th>Function</th><th>Connect To</th></tr></thead><tbody>
<tr><td>red</td><td>motor power</td><td>motor controller output</td></tr>
<tr><td>black</td><td>motor power</td><td>motor controller output</td></tr>
<tr><td>blue</td><td>encoder power</td><td>+3.3 V</td></tr>
<tr><td>green</td><td>encoder ground</td><td>pico ground</td></tr>
<tr><td>yellow</td><td>encoder signal</td><td>pico pin 2</td></tr>
<tr><td>white</td><td>encoder signal</td><td>pico pin 3</td></tr>
</tbody></table>
</div>
<h2 id="motor-controllers"><a class="header" href="#motor-controllers">Motor Controllers</a></h2>
<p>Connections for the motor drivers will be referenced to... the following photo,
as it's much easier to talk about colors than about pin numbers when you can't
actually see the pin numbers written on the board.</p>
<p><strong>Note:</strong> the right side of the green terminal block connects to controller
power (red positive, black ground), and the left side of the block is the
output.</p>
<p><img src="./images/example-motor-controller.jpg" alt="example motor controller" /></p>
<h3 id="steering-motor-controller"><a class="header" href="#steering-motor-controller">Steering Motor Controller</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Color</th><th>Function</th><th>Connect To</th></tr></thead><tbody>
<tr><td>red</td><td>logic power</td><td>+5 V</td></tr>
<tr><td>brown</td><td>logic ground</td><td>pico ground</td></tr>
<tr><td>orange</td><td>enable</td><td>pico pin 4</td></tr>
<tr><td>yellow</td><td>~enable</td><td>pico ground</td></tr>
<tr><td>green</td><td>polarity</td><td>pico pin 5</td></tr>
<tr><td>blue</td><td>polarity</td><td>pico pin 6</td></tr>
</tbody></table>
</div>
<h3 id="rear-motor-controller"><a class="header" href="#rear-motor-controller">Rear Motor Controller</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Color</th><th>Function</th><th>Connect To</th></tr></thead><tbody>
<tr><td>red</td><td>logic power</td><td>+5 V</td></tr>
<tr><td>brown</td><td>logic ground</td><td>pico ground</td></tr>
<tr><td>orange</td><td>enable</td><td>pico pin 11</td></tr>
<tr><td>yellow</td><td>~enable</td><td>pico ground</td></tr>
<tr><td>green</td><td>polarity</td><td>pico pin 12</td></tr>
<tr><td>blue</td><td>polarity</td><td>pico pin 13</td></tr>
</tbody></table>
</div>
<h2 id="rear-encoders"><a class="header" href="#rear-encoders">Rear Encoders</a></h2>
<p>The rear encoders each have four wires coming out of them, which connect as
follows.</p>
<h3 id="right-rear-encoder"><a class="header" href="#right-rear-encoder">Right Rear Encoder</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Color</th><th>Function</th><th>Connect To</th></tr></thead><tbody>
<tr><td>red</td><td>encoder power</td><td>+3.3 V</td></tr>
<tr><td>black</td><td>encoder ground</td><td>pico ground</td></tr>
<tr><td>green</td><td>encoder output</td><td>pico pin 7</td></tr>
<tr><td>white</td><td>encoder output</td><td>pico pin 8</td></tr>
</tbody></table>
</div>
<h3 id="left-rear-encoder"><a class="header" href="#left-rear-encoder">Left Rear Encoder</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Color</th><th>Function</th><th>Connect To</th></tr></thead><tbody>
<tr><td>red</td><td>encoder power</td><td>+3.3 V</td></tr>
<tr><td>black</td><td>encoder ground</td><td>pico ground</td></tr>
<tr><td>green</td><td>encoder output</td><td>pico pin 9</td></tr>
<tr><td>white</td><td>encoder output</td><td>pico pin 10</td></tr>
</tbody></table>
</div>
<h2 id="single-wire-debug"><a class="header" href="#single-wire-debug">Single Wire Debug</a></h2>
<p>These connections are hard to describe, so just take a look at the following
pictures. Note that the order of the wires is flipped between the two, and that
the wires are plugged into the Pi on outside GPIO pins 9, 10, and 11.</p>
<p><img src="./images/pico-debug-wires.jpg" alt="pico debug wires" /></p>
<p><img src="./images/pi-debug-wires.jpg" alt="pi debug wires" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="tools"><a class="header" href="#tools">Tools</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="programming-her"><a class="header" href="#programming-her">Programming Her</a></h1>
<p>Oh joy! <code>ssh</code> into the Pi for all of this.</p>
<h2 id="packages-youll-need"><a class="header" href="#packages-youll-need">Packages You'll Need</a></h2>
<p>This is what you'll need (probably):</p>
<pre><code class="language-bash">apt update

# for docker (obvs)
apt install docker.io

# for pico sdk
apt install cmake gcc-arm-none-eabi libnewlib-arm-none-eabi build-essential

# for openocd
apt install libtool pkg-config autoconf automake texinfo
</code></pre>
<h2 id="cloning-the-repo"><a class="header" href="#cloning-the-repo">Cloning the Repo</a></h2>
<p>To clone the repo and initialize all the submodules:</p>
<pre><code class="language-bash">git clone git@github.com:CooperUnion/carrie.git # if you have repo access
cd carrie/
git submodule update --init
</code></pre>
<h2 id="creating--using-the-docker-image"><a class="header" href="#creating--using-the-docker-image">Creating &amp; Using the Docker Image</a></h2>
<p>There are some convenience scripts available for your convenience.</p>
<pre><code class="language-bash">cd pi/
./container-init.sh # once, to create the container
./container-run.sh # whenever you need to use it
</code></pre>
<h2 id="building-openocd"><a class="header" href="#building-openocd">Building OpenOCD</a></h2>
<p>You'll have to use a custom-built version of OpenOCD, alas, to get things
working on the Pi. See <a href="https://github.com/raspberrypi/openocd">here</a> for the
original instructions.</p>
<pre><code class="language-bash">cd pico/openocd/
./bootstrap
./configure --enable-ftdi --enable-sysfsgpio --enable-bcm2835gpio
make
sudo make install
</code></pre>
<h2 id="building-the-firmware"><a class="header" href="#building-the-firmware">Building the Firmware</a></h2>
<p>There are more convenient convenience scripts for your convenience here, too!</p>
<pre><code class="language-bash">cd pico/firmware/
./compile.sh
</code></pre>
<h2 id="loading-code--debugging"><a class="header" href="#loading-code--debugging">Loading Code &amp; Debugging</a></h2>
<p>You'll want to be in a <code>tmux</code> session with a few panes for this.</p>
<p>In one pane, run the OpenOCD server. This allows for loading code &amp; debugging
the Pico via SWD.</p>
<pre><code class="language-bash">./openocd-server.sh
</code></pre>
<p>In another pane, start <code>gdb</code>:</p>
<pre><code class="language-bash">./debug.sh
</code></pre>
<p>The <code>gdb</code> pane gives you full debugging power, live. To load new code onto the
Pico, compile the project, then run the following inside <code>gdb</code> (possibly after
pressing Ctrl-C to stop the Pico running):</p>
<pre><code>(gdb) load
(gdb) monitor reset init
(gdb) continue
</code></pre>
<h2 id="working-with-ros"><a class="header" href="#working-with-ros">Working with ROS</a></h2>
<p>This could be (unfortunately) a book in itself.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
